

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="A Fortran regular expresion engine.">
    <meta name="author" content="Amasaki Shinobu" >
    <link rel="icon" href="./favicon.png">

    <title> Forgex—Fortran Regular Expression </title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="./css/pygments.css" rel="stylesheet">
    <link href="./css/font-awesome.min.css" rel="stylesheet">
    <link href="./css/local.css" rel="stylesheet">
      <link  href="./tipuesearch/tipuesearch.css" rel="stylesheet">
      <link href="./css/user.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="./js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="./index.html">Forgex—Fortran Regular Expression </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="page/index.html">Documentation</a></li>
                  <li class="nav-item">
                    <a class="nav-link" href="./lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="./lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="./lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="./lists/types.html">Derived Types</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="./search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <!-- Main component for a primary marketing message or call to action -->
    <div class="p-5 mb-4 bg-light border rounded-3" id="jumbotron">
      <p>A Fortran regular expresion engine.</p>
        <p> Find us on&hellip;</p>
      <p>
        <a class="btn btn-lg btn-primary" href="https://github.com/ShinobuAmasaki/forgex" role="button">GitHub</a>
        
        
        
        
      </p>
    </div>

      <div class="row" id='text'>
        <div class=col-md-8>
          <h1>Forgex—Fortran Regular Expression</h1>
          <!-- Readme[EN] version 4.2 -->
<p><a href="https://github.com/ShinobuAmasaki/forgex/actions/workflows/forgex-test-gfortan.yaml"><img alt="Tested with GFortran on Ubuntu" src="https://github.com/ShinobuAmasaki/forgex/actions/workflows/forgex-test-gfortan.yaml/badge.svg?branch=main&amp;event=push"></a>
<a href="https://github.com/ShinobuAmasaki/forgex/actions/workflows/forgex-test-flang.yaml"><img alt="Tested with LLVM Flang on Ubuntu" src="https://github.com/ShinobuAmasaki/forgex/actions/workflows/forgex-test-flang.yaml/badge.svg?branch=main&amp;event=push"></a></p>
<p>Forgex—Fortran Regular Expression—is a regular expression engine written entirely in Fortran.</p>
<p>This project is managed by <a href="https://fpm.fortran-lang.org/index.html">Fortran Package Manager (FPM)</a>, providing basic processing of regular expression, and as a freely available under the MIT license.
The engine's core algorithm uses a deterministic finite automaton (DFA) approach. This choice have been focused on runtime performance.</p>
<h2>Features</h2>
<h4>Metacharacter</h4>
<ul>
<li><code>|</code>  Vertical bar for alternation,</li>
<li><code>*</code>  Asterisk, match zero or more,</li>
<li><code>+</code>  Plus, match one or more,</li>
<li><code>?</code>  Question, match zero or one,</li>
<li><code>\</code>  escape metacharacter,</li>
<li><code>.</code>  match any character.</li>
</ul>
<h4>Character class</h4>
<ul>
<li>character class <code>[a-z]</code></li>
<li>inverted character class <code>[^a-z]</code></li>
<li>character class on UTF-8 codeset <code>[α-ωぁ-ん]</code></li>
<li>shorthands in character class <code>[\d]</code></li>
</ul>
<p>Note that inverted class does not match the control characters.</p>
<h4>Range of repetition</h4>
<ul>
<li><code>{num}</code>,</li>
<li><code>{,max}</code>,</li>
<li><code>{min,}</code>,</li>
<li><code>{min, max}</code>,
where <code>num</code> and <code>max</code> must NOT be zero.</li>
</ul>
<p>To use a literal left curly brace <code>{</code>, escape it with a backslash: <code>\{</code>.</p>
<h4>Anchor</h4>
<ul>
<li><code>^</code>, matches the beginning of a line</li>
<li><code>$</code>, matches the end of a line</li>
</ul>
<h4>Shorthand</h4>
<ul>
<li><code>\t</code>, tab character</li>
<li><code>\n</code>, new line character (LF or CRLF)</li>
<li><code>\r</code>, return character (CR)</li>
<li><code>\s</code>, blank character (white space, TAB, CR, LF, FF, "Zenkaku" space U+3000)</li>
<li><code>\S</code>, non-blank character</li>
<li><code>\w</code>, (<code>[a-zA-Z0-9_]</code>)</li>
<li><code>\W</code>, (<code>[^a-zA-Z0-9_]</code>)</li>
<li><code>\d</code>, digit character (<code>[0-9]</code>)</li>
<li><code>\D</code>, non-digit character (<code>[^0-9]</code>)</li>
</ul>
<h3>Experimental Features</h3>
<h4>Non-UTF-8 Input</h4>
<p><strong>Note: It is the user's responsibility to ensure that input text and the regular expression patterns passed to the API are composed of UTF-8 encoding.</strong></p>
<p>Version 4.2 adds handling when non-UTF-8 characters are given as input strings. When the processor encounters a non-UTF-8 character, it replaces it byte by byte with U+FFFF and attempts to continue matching. Since this library is primarily focused on UTF-8 string processing, this feature should be considered experimental and preliminary. That is it is intended for simple purposes, such as searching for a pattern that matches ASCII and its class in a text file created with a character encoding that includes ASCII.</p>
<h2>Documentation</h2>
<p>The documentation is available in English and Japanese at <a href="https://shinobuamasaki.github.io/forgex">https://shinobuamasaki.github.io/forgex</a>.</p>
<h2>Usage</h2>
<h3>Build</h3>
<p>Operation has been confirmed with the following compilers:</p>
<ul>
<li>GNU Fortran (<code>gfortran</code>) v13.2.1</li>
<li>Intel Fortran Compiler (<code>ifx</code>) 2024.0.0 20231017</li>
</ul>
<p>It is assumed that you will use the Fortran Package Manager(<code>fpm</code>).</p>
<p>First of all, add the following to your project's <code>fpm.toml</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="k">[dependencies]</span>
<span class="n">forgex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">git</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;https://github.com/shinobuamasaki/forgex&quot;</span><span class="p">}</span>
</code></pre></div>

<h3>Alternative options</h3>
<h4>MacPorts</h4>
<p>If you use macOS, you can install this library by using MacPorts with the following command:</p>
<div class="codehilite"><pre><span></span><code>sudo<span class="w"> </span>port<span class="w"> </span>install<span class="w"> </span>forgex
</code></pre></div>

<p>In this case, the <code>.mod</code> files will be placed in <code>/opt/local/include/forgex</code> and the library file will be placed in <code>/opt/local/lib</code>,
so to compile your source code, run the following command:</p>
<div class="codehilite"><pre><span></span><code>gfortran<span class="w"> </span>main.f90<span class="w"> </span>-I/opt/local/include/forgex<span class="w"> </span>-L/opt/local/lib<span class="w"> </span>-lforgex
</code></pre></div>

<p>If you are using this installation method and want to build using <code>fpm</code>, make the following changes to <code>fpm.toml</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="k">[build]</span>
<span class="n">external-modules</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;forgex&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="n">link</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;forgex&quot;</span><span class="w"> </span><span class="p">]</span>
</code></pre></div>

<p>Then you can build your program with the following command:</p>
<div class="codehilite"><pre><span></span><code>fpm<span class="w"> </span>build<span class="w"> </span>--flag<span class="w"> </span><span class="s2">&quot;-I/opt/local/include/forgex&quot;</span><span class="w"> </span>--link-flag<span class="w"> </span><span class="s2">&quot;-L/opt/local/lib&quot;</span>
</code></pre></div>

<p>See also <a href="https://ports.macports.org/port/forgex/details">https://ports.macports.org/port/forgex/details</a></p>
<h4>CMake</h4>
<p>If you want to build this library with CMake, execute the following command:</p>
<div class="codehilite"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>forgex
cmake<span class="w"> </span>-S<span class="w"> </span>.<span class="w"> </span>-B<span class="w"> </span>build
cmake<span class="w"> </span>--build<span class="w"> </span>build
</code></pre></div>

<p>Then, you can use codes in <code>test/</code> directory to test the library with following command:</p>
<div class="codehilite"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>build
ctest<span class="w"> </span>-C<span class="w"> </span>Debug
</code></pre></div>

<h3>APIs</h3>
<p>When you write <code>use forgex</code> at the header on your program, <code>.in.</code> and <code>.match.</code> operators, <code>regex</code> subroutine, and <code>regex_f</code> function are introduced.</p>
<div class="codehilite"><pre><span></span><code><span class="k">program </span><span class="n">main</span>
<span class="w">   </span><span class="k">use</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">forgex</span>
<span class="w">   </span><span class="k">implicit none</span>
</code></pre></div>

<p>The <code>.in.</code> operator returns true if the pattern is contained in the string.</p>
<div class="codehilite"><pre><span></span><code><span class="k">block</span>
<span class="k">   </span><span class="kt">character</span><span class="p">(:),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">pattern</span><span class="p">,</span><span class="w"> </span><span class="n">str</span>

<span class="w">   </span><span class="n">pattern</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;foo(bar|baz)&#39;</span>
<span class="w">   </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;foobarbaz&quot;</span>
<span class="w">   </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">pattern</span><span class="w"> </span><span class="p">.</span><span class="n">in</span><span class="p">.</span><span class="w"> </span><span class="n">str</span><span class="w">  </span><span class="c">! T</span>

<span class="w">   </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;foofoo&quot;</span>
<span class="w">   </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">pattern</span><span class="w"> </span><span class="p">.</span><span class="n">in</span><span class="p">.</span><span class="w"> </span><span class="n">str</span><span class="w">  </span><span class="c">! F</span>
<span class="k">end block</span>
</code></pre></div>

<p>The <code>.match.</code> operator returns true if the pattern exactly matches the string.</p>
<div class="codehilite"><pre><span></span><code><span class="k">block</span>
<span class="k">   </span><span class="kt">character</span><span class="p">(:),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">pattern</span><span class="p">,</span><span class="w"> </span><span class="n">str</span>

<span class="w">   </span><span class="n">pattern</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;\d{3}-\d{4}&#39;</span>
<span class="w">   </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;100-0001&#39;</span>
<span class="w">   </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">pattern</span><span class="w"> </span><span class="p">.</span><span class="n">match</span><span class="p">.</span><span class="w"> </span><span class="n">str</span><span class="w">  </span><span class="c">! T</span>

<span class="w">   </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;1234567&#39;</span>
<span class="w">   </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">pattern</span><span class="w"> </span><span class="p">.</span><span class="n">match</span><span class="p">.</span><span class="w"> </span><span class="n">str</span><span class="w">  </span><span class="c">! F</span>
<span class="k">end block</span>
</code></pre></div>

<p>Note that the <code>.in.</code> and <code>.match.</code> operators return false for invalid pattern inputs.</p>
<p>The <code>regex</code> is a subroutine that returns the substring of a string that matches pattern as <code>intent(out)</code> argument.</p>
<div class="codehilite"><pre><span></span><code><span class="k">block</span>
<span class="k">   </span><span class="kt">character</span><span class="p">(:),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">pattern</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">res</span>
<span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">length</span>

<span class="w">   </span><span class="n">pattern</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;foo(bar|baz)&#39;</span>
<span class="w">   </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;foobarbaz&#39;</span>

<span class="w">   </span><span class="k">call </span><span class="n">regex</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">res</span><span class="p">)</span>
<span class="w">   </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">res</span><span class="w">                              </span><span class="c">! foobar</span>

<span class="w">   </span><span class="c">! call regex(pattern, str, res, length)</span>
<span class="w">         </span><span class="c">! the value 6 stored in optional `length` variable.</span>

<span class="k">end block</span>
</code></pre></div>

<p>By using the <code>from</code>/<code>to</code> arugments, you can extract substrings from the given string.</p>
<div class="codehilite"><pre><span></span><code><span class="k">block</span>
<span class="k">   </span><span class="kt">character</span><span class="p">(:),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">pattern</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">res</span>
<span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">from</span><span class="p">,</span><span class="w"> </span><span class="n">to</span>

<span class="w">   </span><span class="n">pattern</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;[d-f]{3}&#39;</span>
<span class="w">   </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;abcdefghi&#39;</span>

<span class="w">   </span><span class="k">call </span><span class="n">regex</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">res</span><span class="p">,</span><span class="w"> </span><span class="n">from</span><span class="o">=</span><span class="n">from</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="o">=</span><span class="n">to</span><span class="p">)</span>
<span class="w">   </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">res</span><span class="w">                   </span><span class="c">! def</span>

<span class="w">   </span><span class="c">! The `from` and `to` variables store the indices of the start and end points</span>
<span class="w">   </span><span class="c">! of the matched part of the string `str`, respectively.</span>

<span class="w">   </span><span class="c">! Cut out before the matched part.</span>
<span class="w">   </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">from</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w">        </span><span class="c">! abc</span>

<span class="w">   </span><span class="c">! Cut out the matched part that equivalent to the result argument of the `regex` subrouine.</span>
<span class="w">   </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">(</span><span class="n">from</span><span class="p">:</span><span class="n">to</span><span class="p">)</span><span class="w">         </span><span class="c">! def</span>

<span class="w">   </span><span class="c">! Cut out after the matched part.</span>
<span class="w">   </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">(</span><span class="n">to</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">str</span><span class="p">))</span><span class="w">   </span><span class="c">! ghi</span>

<span class="k">end block</span>
</code></pre></div>

<p>The interface of <code>regex</code> subroutine is following:</p>
<div class="codehilite"><pre><span></span><code><span class="k">interface </span><span class="n">regex</span>
<span class="w">   </span><span class="k">module procedure</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">subroutine__regex</span>
<span class="k">end interface</span>

<span class="k">pure subroutine </span><span class="n">subroutine__regex</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span><span class="w"> </span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="n">res</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"> </span><span class="n">from</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">err_msg</span><span class="p">)</span>
<span class="w">   </span><span class="k">implicit none</span>
<span class="k">   </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w">              </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">pattern</span><span class="p">,</span><span class="w"> </span><span class="n">text</span>
<span class="w">   </span><span class="kt">character</span><span class="p">(:),</span><span class="w"> </span><span class="k">allocatable</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">res</span>
<span class="w">   </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">optional</span><span class="p">,</span><span class="w">         </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"> </span><span class="n">from</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="p">,</span><span class="w"> </span><span class="n">status</span>
<span class="w">   </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="p">,</span><span class="w">    </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">err_msg</span>
</code></pre></div>

<p>The list of all <code>status</code> values is defined in the source file at src/ast/syntax_tree_error_m.f90.</p>
<p>If you want to the matched character string as the return value of the function,
consider using <code>regex_f</code> defined in the <code>forgex</code> module.</p>
<div class="codehilite"><pre><span></span><code><span class="k">interface </span><span class="n">regex_f</span>
<span class="w">   </span><span class="k">module procedure</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">function__regex</span>
<span class="k">end interface </span><span class="n">regex_f</span>

<span class="k">pure function </span><span class="n">function__regex</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span><span class="w"> </span><span class="n">text</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="w">   </span><span class="k">implicit none</span>
<span class="k">   </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">pattern</span><span class="p">,</span><span class="w"> </span><span class="n">text</span>
<span class="w">   </span><span class="kt">character</span><span class="p">(:),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">res</span>
</code></pre></div>

<h4>Validating Regular Expression</h4>
<p>Before calling APIs, you can validate a regex pattern using <code>is_valid_regex</code> function introduced in version 4.0 and later. The interface of <code>is_valid_regex</code> function is following:</p>
<div class="codehilite"><pre><span></span><code><span class="k">interface </span><span class="n">is_valid_regex</span>
<span class="w">   </span><span class="k">module procedure</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">is_valid_regex_pattern</span>
<span class="k">end </span><span class="n">interfac</span>

<span class="k">pure elemental function </span><span class="n">is_valid_regex_pattern</span><span class="w"> </span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="w">   </span><span class="k">implicit none</span>
<span class="k">   </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">pattern</span>
<span class="w">   </span><span class="kt">logical</span><span class="w">                   </span><span class="kd">::</span><span class="w"> </span><span class="n">res</span>
</code></pre></div>

<h4>UTF-8 String matching</h4>
<p>UTF-8 string can be matched using regular expression patterns just like ASCII strings.
The following example demonstrates matching Chinese characters.
In this example, the <code>length</code> variable stores the byte length, and in this case there 10 3-byte characters, so the length is 30.</p>
<div class="codehilite"><pre><span></span><code><span class="k">block</span>
<span class="k">   </span><span class="kt">character</span><span class="p">(:),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">pattern</span><span class="p">,</span><span class="w"> </span><span class="n">str</span>
<span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">length</span>

<span class="w">   </span><span class="n">pattern</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;夢.{1,7}胡蝶&quot;</span>
<span class="w">   </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;昔者莊周夢爲胡蝶　栩栩然胡蝶也&quot;</span>

<span class="w">   </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">pattern</span><span class="w"> </span><span class="p">.</span><span class="n">in</span><span class="p">.</span><span class="w"> </span><span class="n">str</span><span class="w">            </span><span class="c">! T</span>
<span class="w">   </span><span class="k">call </span><span class="n">regex</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">res</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="p">)</span>
<span class="w">   </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">res</span><span class="w">                         </span><span class="c">! 夢爲胡蝶　栩栩然胡蝶</span>
<span class="w">   </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="w">                      </span><span class="c">! 30 (is 3-byte * 10 characters)</span>

<span class="k">end block</span>
</code></pre></div>

<h3>Command Line Interface Tool</h3>
<p>Version 3.2 introduces a command line tool that is called  <code>forgex-cli</code> and uses the Forgex engine for debugging, testing, and benchmarking regex matches. It performs matching with commands such as the one shown in below, and outputs the results directly to standard output. <a href="https://shinobuamasaki.github.io/forgex/page/English/forgex_on_command_line_en.html">For detailed information, please refer to the documentation.</a></p>
<p>Command:</p>
<div class="codehilite"><pre><span></span><code>forgex-cli<span class="w"> </span>find<span class="w"> </span>match<span class="w"> </span>lazy-dfa<span class="w"> </span><span class="s1">&#39;([a-z]*g+)n?&#39;</span><span class="w"> </span>.match.<span class="w"> </span><span class="s1">&#39;assign&#39;</span>
</code></pre></div>

<p>If you run it through <code>fpm run</code>:</p>
<div class="codehilite"><pre><span></span><code>fpm<span class="w"> </span>run<span class="w"> </span>forgex-cli<span class="w"> </span>--profile<span class="w"> </span>release<span class="w"> </span>--<span class="w"> </span>find<span class="w"> </span>match<span class="w"> </span>lazy-dfa<span class="w"> </span><span class="s1">&#39;([a-z]*g+)n?&#39;</span><span class="w"> </span>.match.<span class="w"> </span><span class="s1">&#39;assign&#39;</span>
</code></pre></div>

<p>Output:</p>
<div class="codehilite"><pre><span></span><code><span class="w">            </span><span class="nl">pattern:</span><span class="w"> </span><span class="p">([</span><span class="n">a</span><span class="o">-</span><span class="n">z</span><span class="p">]</span><span class="o">*</span><span class="n">g</span><span class="o">+</span><span class="p">)</span><span class="n">n</span><span class="o">?</span>
<span class="w">               </span><span class="nl">text:</span><span class="w"> </span><span class="p">&#39;</span><span class="k">assign</span><span class="p">&#39;</span>
<span class="w">         </span><span class="n">parse</span><span class="w"> </span><span class="kt">time</span><span class="o">:</span><span class="w">        </span><span class="mf">46.5</span><span class="n">us</span>
<span class="w">   </span><span class="n">compile</span><span class="w"> </span><span class="n">nfa</span><span class="w"> </span><span class="kt">time</span><span class="o">:</span><span class="w">        </span><span class="mf">74.9</span><span class="n">us</span>
<span class="n">dfa</span><span class="w"> </span><span class="n">initialize</span><span class="w"> </span><span class="kt">time</span><span class="o">:</span><span class="w">        </span><span class="mf">78.4</span><span class="n">us</span>
<span class="w">        </span><span class="n">search</span><span class="w"> </span><span class="kt">time</span><span class="o">:</span><span class="w">       </span><span class="mf">661.7</span><span class="n">us</span>
<span class="w">    </span><span class="n">matching</span><span class="w"> </span><span class="nl">result:</span><span class="w">         </span><span class="n">T</span>
<span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="p">(</span><span class="n">estimated</span><span class="p">)</span><span class="o">:</span><span class="w">     </span><span class="mh">10380</span>

<span class="o">==========</span><span class="w"> </span><span class="n">Thompson</span><span class="w"> </span><span class="n">NFA</span><span class="w"> </span><span class="o">===========</span>
<span class="n">state</span><span class="w">    </span><span class="mh">1</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="o">?</span><span class="p">,</span><span class="w"> </span><span class="mh">5</span><span class="p">)</span>
<span class="n">state</span><span class="w">    </span><span class="mh">2</span><span class="o">:</span><span class="w"> </span><span class="o">&lt;</span><span class="n">Accepted</span><span class="o">&gt;</span>
<span class="n">state</span><span class="w">    </span><span class="mh">3</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="p">)(</span><span class="o">?</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="p">)</span>
<span class="n">state</span><span class="w">    </span><span class="mh">4</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="mh">7</span><span class="p">)</span>
<span class="n">state</span><span class="w">    </span><span class="mh">5</span><span class="o">:</span><span class="w"> </span><span class="p">([</span><span class="s">&quot;a&quot;</span><span class="o">-</span><span class="s">&quot;f&quot;</span><span class="p">],</span><span class="w"> </span><span class="mh">6</span><span class="p">)(</span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="mh">6</span><span class="p">)([</span><span class="s">&quot;h&quot;</span><span class="o">-</span><span class="s">&quot;m&quot;</span><span class="p">],</span><span class="w"> </span><span class="mh">6</span><span class="p">)(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="mh">6</span><span class="p">)([</span><span class="s">&quot;o&quot;</span><span class="o">-</span><span class="s">&quot;z&quot;</span><span class="p">],</span><span class="w"> </span><span class="mh">6</span><span class="p">)(</span><span class="o">?</span><span class="p">,</span><span class="w"> </span><span class="mh">4</span><span class="p">)</span>
<span class="n">state</span><span class="w">    </span><span class="mh">6</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="o">?</span><span class="p">,</span><span class="w"> </span><span class="mh">5</span><span class="p">)</span>
<span class="n">state</span><span class="w">    </span><span class="mh">7</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="o">?</span><span class="p">,</span><span class="w"> </span><span class="mh">8</span><span class="p">)</span>
<span class="n">state</span><span class="w">    </span><span class="mh">8</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="mh">9</span><span class="p">)(</span><span class="o">?</span><span class="p">,</span><span class="w"> </span><span class="mh">3</span><span class="p">)</span>
<span class="n">state</span><span class="w">    </span><span class="mh">9</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="o">?</span><span class="p">,</span><span class="w"> </span><span class="mh">8</span><span class="p">)</span>
<span class="o">===============</span><span class="w"> </span><span class="n">DFA</span><span class="w"> </span><span class="o">===============</span>
<span class="w">   </span><span class="mh">1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;a&quot;</span><span class="o">-</span><span class="s">&quot;f&quot;</span><span class="p">]</span><span class="o">=&gt;</span><span class="mh">2</span>
<span class="w">   </span><span class="mh">2</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;o&quot;</span><span class="o">-</span><span class="s">&quot;z&quot;</span><span class="p">]</span><span class="o">=&gt;</span><span class="mh">2</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;h&quot;</span><span class="o">-</span><span class="s">&quot;m&quot;</span><span class="p">]</span><span class="o">=&gt;</span><span class="mh">2</span><span class="w"> </span><span class="n">g</span><span class="o">=&gt;</span><span class="mh">3</span>
<span class="w">   </span><span class="mh">3</span><span class="nl">A:</span><span class="w"> </span><span class="n">n</span><span class="o">=&gt;</span><span class="mh">4</span>
<span class="w">   </span><span class="mh">4</span><span class="nl">A:</span>
<span class="n">state</span><span class="w">    </span><span class="mh">1</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mh">1</span><span class="w"> </span><span class="mh">4</span><span class="w"> </span><span class="mh">5</span><span class="w"> </span><span class="p">)</span>
<span class="n">state</span><span class="w">    </span><span class="mh">2</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mh">4</span><span class="w"> </span><span class="mh">5</span><span class="w"> </span><span class="mh">6</span><span class="w"> </span><span class="p">)</span>
<span class="n">state</span><span class="w">    </span><span class="mh">3</span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mh">2</span><span class="w"> </span><span class="mh">3</span><span class="w"> </span><span class="mh">4</span><span class="w"> </span><span class="mh">5</span><span class="w"> </span><span class="mh">6</span><span class="w"> </span><span class="mh">7</span><span class="w"> </span><span class="mh">8</span><span class="w"> </span><span class="p">)</span>
<span class="n">state</span><span class="w">    </span><span class="mh">4</span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mh">2</span><span class="w"> </span><span class="mh">4</span><span class="w"> </span><span class="mh">5</span><span class="w"> </span><span class="mh">6</span><span class="w"> </span><span class="p">)</span>
<span class="o">===================================</span>
</code></pre></div>

<h3>Notes</h3>
<ul>
<li>A program built by <code>gfortran</code> on Windows and macOC may crash if an allocatable character is used in an OpenMP parallel block.</li>
<li>If you use the command line tool with PowerShell on Windows, use UTF-8 as your system locale to properly input and output Unicode characters.</li>
<li>As internal changes to the API related to the addition of the <code>is_valid_regex</code> function, the <code>.in.</code> and <code>.match.</code> operators now return False for invalid pattern input (in versions prior to 3.5 they would terminate processing by executing an <code>error stop</code> statement).</li>
</ul>
<h2>To do</h2>
<ul>
<li>Character class subtraction: <code>[a-z--b-d]</code></li>
<li>Add Unicode escape sequence <code>\p{...}</code></li>
<li>Add 256 characters' escape sequence: <code>\x..</code></li>
<li>✅️ Deal with invalid byte strings in UTF-8</li>
<li>✅️ Optimize by literal searching method</li>
<li>✅️ Add a CLI tool for debugging and benchmarking</li>
<li>✅️ Make all operators <code>pure elemental</code> attribute</li>
<li>✅️ Publish the documentation</li>
<li>✅️ Support UTF-8 basic feature</li>
<li>✅️ Construct DFA on-the-fly</li>
<li>✅️ Support CMake building</li>
<li><s>Parallelize on matching</s></li>
</ul>
<h2>Code Convention</h2>
<p>All code contained herein shall be written with a three-space indentation.</p>
<h2>Acknowledgements</h2>
<p>For the algorithm of the power set construction method and syntax analysis, I referred to Russ Cox's article and Yoshiyuki Kondo's book.
The implementation of the priority queue was based on <a href="https://github.com/ue1221/fortran-utilities">the code written by ue1221</a>.
The idea of applying the <code>.in.</code> operator to strings was inspired by kazulagi's one.
The command-line interface design of <code>forgex-cli</code> was inspired in part by the package <code>regex-cli</code> of Rust language.</p>
<h2>References</h2>
<ol>
<li>Russ Cox <a href="https://swtch.com/~rsc/regexp/regexp1.html">"Regular Expression Matching Can Be Simple And Fast"</a>, 2007</li>
<li>近藤嘉雪 (Yoshiyuki Kondo), "定本 Cプログラマのためのアルゴリズムとデータ構造", 1998, SB Creative.</li>
<li><a href="https://github.com/ue1221/fortran-utilities">ue1221/fortran-utilities</a></li>
<li>Haruka Tomobe (kazulagi), <a href="https://github.com/kazulagi">https://github.com/kazulagi</a>, <a href="https://qiita.com/soybean/items/7cdd2156a9d8843c0d91">his article in Japanese</a></li>
<li><a href="https://github.com/rust-lang/regex/tree/master/regex-cli">rust-lang/regex/regex-cli</a></li>
</ol>
<h2>License</h2>
<p>Forgex is as a freely available under the MIT license. See <a href="https://github.com/ShinobuAmasaki/forgex/blob/main/LICENSE">LICENSE</a>.</p>
        </div>
          <div class="col-md-4">
            <div class="card card-body bg-light">
                <img src="https://shinobuamasaki.github.io/img/shinobu.png" alt="Developer picture" class="card-img-top">
              <h2 class="card-title">Developer Info</h2>
              <h4 class="card-text">Amasaki Shinobu</h4>
              <p class="card-text"></p>
                <div class="text-center"><div class="btn-group" role="group">
                    <a class="btn btn-lg btn-primary" href="https://shinobuamasaki.github.io"><i class="fa fa-globe fa-lg"></i></a>
                    <a class="btn btn-lg btn-primary" href="https://github.com/ShinobuAmasaki"><i class="fa fa-github fa-lg"></i></a>
                    
                    
                    
                    
                    
                    <a class="btn btn-lg btn-primary" href="https://x.com/amasaki203"><i class="fa fa-twitter fa-lg"></i></a>
                </div></div>
            </div>
          </div>
      </div>
        <div class="row">
          <hr>
          <div class="col-xs-6 col-sm-3">
            <div>
              <h3>Source Files</h3>
              <ul><li><a href='sourcefile/api_internal_m.f90.html'>api_internal_m.F90</a></li><li><a href='sourcefile/automaton_m.f90.html'>automaton_m.F90</a></li><li><a href='sourcefile/character_array_m.f90.html'>character_array_m.F90</a></li><li><a href='sourcefile/dense_dfa_m.f90.html'>dense_dfa_m.f90</a></li><li><a href='sourcefile/enums_m.f90.html'>enums_m.f90</a></li><li><a href='sourcefile/error_m.f90.html'>error_m.F90</a></li><li><a href='sourcefile/forgex.f90.html'>forgex.F90</a></li><li><a href='sourcefile/lazy_dfa_graph_m.f90.html'>lazy_dfa_graph_m.F90</a></li><li><a href='sourcefile/lazy_dfa_node_m.f90.html'>lazy_dfa_node_m.F90</a></li><li><a href='sourcefile/nfa_graph_m.f90.html'>nfa_graph_m.F90</a></li></ul>
            </div>
            <div>
              <ul>
                <li><a href="./lists/files.html"><em>All source files&hellip;</em></a></li>
              </ul>
            </div>
          </div>
          <div class="col-xs-6 col-sm-3">
            <div>
              <h3>Modules</h3>
              <ul><li><a href='module/forgex.html'>forgex</a></li><li><a href='module/forgex_api_internal_m.html'>forgex_api_internal_m</a></li><li><a href='module/forgex_automaton_m.html'>forgex_automaton_m</a></li><li><a href='module/forgex_character_array_m.html'>forgex_character_array_m</a></li><li><a href='module/forgex_dense_dfa_m.html'>forgex_dense_dfa_m</a></li><li><a href='module/forgex_enums_m.html'>forgex_enums_m</a></li><li><a href='module/forgex_error_m.html'>forgex_error_m</a></li><li><a href='module/forgex_lazy_dfa_graph_m.html'>forgex_lazy_dfa_graph_m</a></li><li><a href='module/forgex_lazy_dfa_node_m.html'>forgex_lazy_dfa_node_m</a></li><li><a href='module/forgex_nfa_graph_m.html'>forgex_nfa_graph_m</a></li></ul>
            </div>
            <div>
              <ul>
                <li><a href="./lists/modules.html"><em>All modules&hellip;</em></a></li>
              </ul>
            </div>
          </div>
          <div class="col-xs-6 col-sm-3">
            <div>
              <h3>Procedures</h3>
              <ul><li><a href='proc/add_nfa_state.html'>add_nfa_state</a></li><li><a href='proc/adjustl_multi_byte.html'>adjustl_multi_byte</a></li><li><a href='proc/arg_in_segment.html'>arg_in_segment</a></li><li><a href='proc/arg_in_segment_list.html'>arg_in_segment_list</a></li><li><a href='proc/automaton__build_nfa.html'>automaton__build_nfa</a></li><li><a href='proc/automaton__compute_reachable_state.html'>automaton__compute_reachable_state</a></li><li><a href='proc/automaton__construct_dfa.html'>automaton__construct_dfa</a></li><li><a href='proc/automaton__deallocate.html'>automaton__deallocate</a></li><li><a href='proc/automaton__destination.html'>automaton__destination</a></li><li><a href='proc/automaton__epsilon_closure.html'>automaton__epsilon_closure</a></li></ul>
            </div>
            <div>
              <ul>
                <li><a href="./lists/procedures.html"><em>All procedures&hellip;</em></a></li>
              </ul>
            </div>
          </div>
          <div class="col-xs-6 col-sm-3">
            <div>
              <h3>Derived Types</h3>
              <ul><li><a href='type/automaton_t.html'>automaton_t</a></li><li><a href='type/character_array_t.html'>character_array_t</a></li><li><a href='type/dfa_graph_t.html'>dfa_graph_t</a></li><li><a href='type/dfa_state_node_t.html'>dfa_state_node_t</a></li><li><a href='type/dfa_transition_t.html'>dfa_transition_t</a></li><li><a href='type/nfa_graph_t.html'>nfa_graph_t</a></li><li><a href='type/nfa_state_node_t.html'>nfa_state_node_t</a></li><li><a href='type/nfa_state_set_t.html'>nfa_state_set_t</a></li><li><a href='type/nfa_transition_t.html'>nfa_transition_t</a></li><li><a href='type/priority_queue_t.html'>priority_queue_t</a></li></ul>
            </div>
            <div>
              <ul>
                <li><a href="./lists/types.html"><em>All derived types&hellip;</em></a></li>
              </ul>
            </div>
          </div>
        </div>
      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              Forgex—Fortran Regular Expression
 was developed by Amasaki Shinobu<br>              &copy; 2023-2024 <a rel="license" href="https://opensource.org/licenses/MIT">MIT</a>
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2025-03-04 07:33 +0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>    

    <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

          <script src="./tipuesearch/tipuesearch_content.js"></script>
          <script src="./tipuesearch/tipuesearch_set.js"></script>
          <script src="./tipuesearch/tipuesearch.js"></script>

  </body>
</html>